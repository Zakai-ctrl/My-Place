<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zakai's Place: Connect Four</title>
    <style>
        body {
            text-align: center;
            background-color: rgb(7, 7, 7);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #Four {
            color: green;
            margin-bottom: 20px;
        }
        .game-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 30px;
        }
        #Box {
            display: grid;
            grid-template-columns: repeat(7, 70px);
            grid-gap: 10px;
            justify-content: center;
            margin: auto;
            padding: 25px;
        }
        .Slot {
            width: 70px;
            height: 70px;
            background-color: gray;
            border-radius: 50%;
            border: 2px solid black;
            cursor: pointer;
        }
        .red {
            background-color: red;
        }
        .yellow {
            background-color: yellow;
        }
        .winner {
            border: 3px solid gold;
        }
        .button-container {
            margin: 20px;
        }
        .btn {
            background-color: black;
            color: green;
            border: 2px solid green;
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background-color: green;
            color: black;
        }
        #win {
            font-size: 2em;
            color: green;
            margin-top: 20px;
        }
        #Redwin, #Yellowwin {
            display: none;
            font-size: 2em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1 id="Four">Here's Connect Four <br><strong><span style="font-size: 2em;">Enjoy!</span></strong></h1>

    <div class="button-container">
        <a href="index.html">
            <button class="btn" id="backButton">Back</button>
        </a> 
        <button class="btn" id="modeButton">Switch to One Player</button>
    </div>

    <div class="game-container">
        <div id="Box">
            <!-- Slots will be dynamically created by JavaScript -->
        </div>
    </div>

    <div id="Redwin"><strong><span>RED WINS</span></strong></div> 
    <div id="Yellowwin"><strong><span>YELLOW WINS</span></strong></div> 

    <script>
        const rows = 6;
        const cols = 7;
        let currentPlayer = 'red';
        let isTwoPlayerMode = true;
        let gameOver = false;
        const board = Array.from({ length: rows }, () => Array(cols).fill(null));

        const box = document.getElementById('Box');
        const redWinDiv = document.getElementById('Redwin');
        const yellowWinDiv = document.getElementById('Yellowwin');
        for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
                const slot = document.createElement('div');
                slot.className = 'Slot';
                slot.dataset.row = row;
                slot.dataset.col = col;
                box.appendChild(slot);
            }
        }

        const slots = document.querySelectorAll('.Slot');
        const modeButton = document.getElementById('modeButton');

        slots.forEach(slot => slot.addEventListener('click', handleClick));
        modeButton.addEventListener('click', toggleMode);

        function handleClick(event) {
            if (gameOver || !isValidClick(event)) return;

            const col = parseInt(event.target.dataset.col);
            const availableRow = getAvailableRow(col);
            if (availableRow === null) return;

            board[availableRow][col] = currentPlayer;
            const selectedSlot = document.querySelector(`.Slot[data-row="${availableRow}"][data-col="${col}"]`);
            selectedSlot.classList.add(currentPlayer);

            if (checkWin(availableRow, col)) {
                highlightWinningSequence(availableRow, col);
                announceWinner(`${currentPlayer}`);
                gameOver = true;
            } else if (board.flat().every(cell => cell !== null)) {
                announceWinner("tie");
                gameOver = true;
            } else {
                currentPlayer = currentPlayer === 'red' ? 'yellow' : 'red';
                if (!isTwoPlayerMode && currentPlayer === 'yellow') {
                    setTimeout(computerMove, 500);
                }
            }
        }

        function isValidClick(event) {
            if (!isTwoPlayerMode && currentPlayer === 'yellow') return false;
            return true;
        }

        function getAvailableRow(col) {
            for (let row = rows - 1; row >= 0; row--) {
                if (board[row][col] === null) {
                    return row;
                }
            }
            return null;
        }

        function checkWin(row, col) {
            return (
                checkDirection(row, col, 1, 0) || // horizontal
                checkDirection(row, col, 0, 1) || // vertical
                checkDirection(row, col, 1, 1) || // diagonal /
                checkDirection(row, col, 1, -1)   // diagonal \
            );
        }

        function checkDirection(row, col, rowDelta, colDelta) {
            let count = 0;
            let r = row;
            let c = col;
            const winningSlots = [];

            while (isValidCell(r, c) && board[r][c] === currentPlayer) {
                count++;
                winningSlots.push({ r, c });
                r += rowDelta;
                c += colDelta;
            }

            r = row - rowDelta;
            c = col - colDelta;

            while (isValidCell(r, c) && board[r][c] === currentPlayer) {
                count++;
                winningSlots.push({ r, c });
                r -= rowDelta;
                c -= colDelta;
            }

            if (count >= 4) {
                highlightWinningSequence(winningSlots);
                return true;
            }
            return false;
        }

        function isValidCell(row, col) {
            return row >= 0 && row < rows && col >= 0 && col < cols;
        }

        function highlightWinningSequence(winningSlots) {
            winningSlots.forEach(({ r, c }) => {
                const slot = document.querySelector(`.Slot[data-row="${r}"][data-col="${c}"]`);
                slot.classList.add('winner');
            });
        }

        function resetGame() {
            board.forEach(row => row.fill(null));
            slots.forEach(slot => {
                slot.classList.remove('red', 'yellow', 'winner');
            });
            currentPlayer = 'red';
            gameOver = false;
            redWinDiv.style.display = 'none';
            yellowWinDiv.style.display = 'none';
        }

        function toggleMode() {
            isTwoPlayerMode = !isTwoPlayerMode;
            modeButton.textContent = isTwoPlayerMode ? 'Switch to One Player' : 'Switch to Two Players';
            resetGame();
        }

        function announceWinner(winner) {
            if (winner === 'red') {
                redWinDiv.style.display = 'block';
                yellowWinDiv.style.display = 'none';
            } else if (winner === 'yellow') {
                yellowWinDiv.style.display = 'block';
                redWinDiv.style.display = 'none';
            }
        }

        function computerMove() {
            let col;
            do {
                col = Math.floor(Math.random() * cols);
            } while (getAvailableRow(col) === null);

            const availableRow = getAvailableRow(col);
            board[availableRow][col] = 'yellow';
            const selectedSlot = document.querySelector(`.Slot[data-row="${availableRow}"][data-col="${col}"]`);
            selectedSlot.classList.add('yellow');

            if (checkWin(availableRow, col)) {
                highlightWinningSequence(availableRow, col);
                announceWinner("yellow");
                gameOver = true;
            } else {
                currentPlayer = 'red';
            }
        }
    </script>
</body>
</html>
